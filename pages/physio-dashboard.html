<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NeuroTrack Physiotherapist Dashboard">
    <title>Physiotherapist Dashboard | NeuroTrack</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/dashboard.css">
</head>
<body>
    <!-- Header Navigation -->
    <header class="dashboard-header">
        <div class="header-container">
            <!-- Logo -->
            <a href="#" class="header-logo">
                <img src="../assets/img/logo.png" alt="NeuroTrack Logo" class="header-logo__image">
            </a>

            <!-- Navigation Links -->
            <nav class="header-nav">
                <a href="./physio-dashboard.html" class="header-nav__link active">Dashboard</a>
                <a href="#" class="header-nav__link">Schedule</a>
                <a href="#" class="header-nav__link">Message</a>
            </nav>

            <!-- Actions -->
            <div class="header-actions">
                <!-- Notification Bell - Filled Icon -->
                <div style="position: relative;">
                    <button class="header-notification" aria-label="Notifications" title="Notifications" onclick="toggleNotifications()">
                        <svg class="notification-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"/>
                        </svg>
                        <span class="header-notification__badge"></span>
                    </button>
                    
                    <!-- Notification Dropdown -->
                    <div class="notification-dropdown" id="notificationDropdown">
                        <div class="notification-dropdown__header">
                            <span class="notification-dropdown__title">Notifications</span>
                            <span class="notification-dropdown__count">4</span>
                        </div>
                        <div class="notification-dropdown__list" id="notificationList">
                            <!-- Notifications will be inserted here by JavaScript -->
                        </div>
                        <div class="notification-dropdown__footer">
                            <a href="#">View all notifications</a>
                        </div>
                    </div>
                </div>

                <!-- User Profile - Round Photo -->
                <div class="header-user" onclick="toggleUserMenu()">
                    <div class="header-user__info">
                        <div class="header-user__name" id="userName">Psikioterapi Specialist</div>
                        <div class="header-user__role" id="userRole">Physiotherapist</div>
                    </div>
                    <div class="header-user__avatar" id="userAvatar">
                        <!-- Profile photo will be inserted here or show initial -->
                        P
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="dashboard-main">
        <div class="dashboard-container">
            <h1>Physiotherapist Dashboard</h1>
            <p>Guide rehabilitation sessions and monitor patient adherence.</p>
        </div>
    </main>

    <script>
        // Physiotherapist-specific notifications
        const physioNotifications = [
            { icon: 'info', title: 'Session Scheduled', description: 'New rehabilitation session scheduled with patient Robert Chen tomorrow at 9:00 AM', time: '10 min ago', unread: true },
            { icon: 'success', title: 'Exercise Plan Approved', description: 'Dr. Williams has approved your customized exercise plan for patient Jennifer Lopez', time: '30 min ago', unread: true },
            { icon: 'warning', title: 'Equipment Maintenance', description: 'Treadmill #3 requires maintenance. Please use alternative equipment for walking exercises', time: '1 hour ago', unread: true },
            { icon: 'info', title: 'Patient Progress Note', description: 'Patient Mark Johnson has completed 90% of assigned exercises this week. Excellent adherence!', time: '3 hours ago', unread: true },
            { icon: 'success', title: 'Training Workshop', description: 'New techniques workshop on post-stroke gait training available. Register by end of week', time: '5 hours ago', unread: false },
            { icon: 'info', title: 'Assessment Due', description: 'Quarterly mobility assessment for patient Amanda White is due in 3 days', time: 'Yesterday', unread: false },
            { icon: 'warning', title: 'Room Change', description: 'Your 2:00 PM session has been moved from Therapy Room A to Therapy Room C', time: 'Yesterday', unread: false },
            { icon: 'success', title: 'Patient Feedback', description: 'Patient Thomas Anderson left positive feedback about your rehabilitation guidance', time: '2 days ago', unread: false },
            { icon: 'info', title: 'New Equipment Arrival', description: 'Balance training equipment has arrived and is now available in the therapy center', time: '3 days ago', unread: false },
            { icon: 'info', title: 'Protocol Update', description: 'Updated rehabilitation protocols for stroke patients have been published in your resource library', time: '1 week ago', unread: false }
        ];

        // Toggle notification dropdown
        function toggleNotifications() {
            const dropdown = document.getElementById('notificationDropdown');
            const button = document.querySelector('.header-notification');
            dropdown.classList.toggle('active');
            button.classList.toggle('active');
        }

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            const dropdown = document.getElementById('notificationDropdown');
            const button = document.querySelector('.header-notification');
            if (dropdown && !dropdown.contains(e.target) && !button.contains(e.target)) {
                dropdown.classList.remove('active');
                button.classList.remove('active');
            }
        });

        // Load notifications
        function loadNotifications() {
            const listContainer = document.getElementById('notificationList');
            listContainer.innerHTML = physioNotifications.map(notif => `
                <div class="notification-item ${notif.unread ? 'unread' : ''}">
                    <div class="notification-item__icon ${notif.icon}">
                        ${notif.icon === 'info' ? '‚ÑπÔ∏è' : notif.icon === 'success' ? '‚úÖ' : notif.icon === 'warning' ? '‚ö†Ô∏è' : 'üîî'}
                    </div>
                    <div class="notification-item__content">
                        <div class="notification-item__title">${notif.title}</div>
                        <div class="notification-item__description">${notif.description}</div>
                        <div class="notification-item__time">${notif.time}</div>
                    </div>
                </div>
            `).join('');
            
            // Update notification count
            const unreadCount = physioNotifications.filter(n => n.unread).length;
            document.querySelector('.notification-dropdown__count').textContent = unreadCount;
        }

        // Load user data from localStorage
        window.addEventListener('DOMContentLoaded', () => {
            const userData = JSON.parse(localStorage.getItem('neurotrack_user') || '{}');
            
            if (!userData.role || userData.role !== 'physio') {
                // Redirect to login if not authenticated or wrong role
                window.location.href = './login.html';
                return;
            }
            
            // Update header with user data
            document.getElementById('userName').textContent = userData.profile?.fullName || 'Psikioterapi Specialist';
            document.getElementById('userRole').textContent = 'Physiotherapist';
            
            // Update avatar with first letter of name
            const firstLetter = (userData.profile?.fullName || 'P').charAt(0).toUpperCase();
            document.getElementById('userAvatar').textContent = firstLetter;
            
            // Load notifications
            loadNotifications();
        });

        function toggleUserMenu() {
            // Placeholder for user menu functionality
            const confirmLogout = confirm('Do you want to log out?');
            if (confirmLogout) {
                localStorage.removeItem('neurotrack_user');
                window.location.href = './login.html';
            }
        }
    </script>
</body>
</html>
